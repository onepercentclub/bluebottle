# Generated by Django 4.2.20 on 2025-12-10 12:51

from django.db import migrations


def add_permission_to_groups(apps, schema_editor):
    Group = apps.get_model('auth', 'Group')
    Permission = apps.get_model('auth', 'Permission')
    ContentType = apps.get_model('contenttypes', 'ContentType')
    Activity = apps.get_model('activities', 'Activity')

    ct = ContentType.objects.get_for_model(Activity)
    perm, _ = Permission.objects.get_or_create(
        codename='api_review_activity',
        content_type=ct,
        defaults={'name': 'Can review activities'}
    )

    for name in ["Staff", "Region manager"]:
        group = Group.objects.filter(name=name).first()
        if group:
            group.permissions.add(perm)


class Migration(migrations.Migration):
    dependencies = [
        ('activities', '0099_alter_activity_options'),
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.RunPython(add_permission_to_groups, migrations.RunPython.noop),
    ]
