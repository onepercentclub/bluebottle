# -*- coding: utf-8 -*-
# Generated by Django 1.11.15 on 2020-01-29 12:34
from __future__ import unicode_literals
import datetime

from django.db import migrations
from django.utils.timezone import get_current_timezone

def migrate_assignments(apps, schema_editor):
    Applicant = apps.get_model('assignments', 'Applicant')

    for applicant in Applicant.objects.all():
        applicant.contribution_date=get_current_timezone().localize(
            datetime.datetime(
                applicant.activity.assignment.end_date.year, applicant.activity.assignment.end_date.month, applicant.activity.assignment.end_date.day
            )
        )
        applicant.save()

class Migration(migrations.Migration):

    dependencies = [
        ('activities', '0015_auto_20200128_1045'),
        ('assignments', '0012_auto_20190913_1547'),
    ]

    operations = [
            migrations.RunPython(migrate_assignments,migrations.RunPython.noop)
    ]
