# -*- coding: utf-8 -*-
# Generated by Django 1.11.15 on 2020-08-18 07:56
from __future__ import unicode_literals

from django.db import migrations, models
from bluebottle.clients import properties
from parler.models import TranslatableModelMixin


def create_default_impact_types(apps, schema_editor):
    ImpactType = apps.get_model('impact', 'ImpactType')
    ImpactType.__bases__ = (models.Model, TranslatableModelMixin)

    ImpactTypeTranslation = apps.get_model('impact', 'ImpactTypeTranslation')
    Language = apps.get_model('utils', 'language')

    languages = [lang.code for lang in Language.objects.all()]

    definitions = [
        {
            'slug': 'co2',
            'icon': 'co2',
            'en': {
                'name': u'Reduce CO₂ emissions',
                'unit': u'kg',
                'text': u'reduce CO₂ emissions',
                'text_with_target': 'CO₂ emissions reduced',
                'text_passed': u'reduce CO₂ emissions by {} kg',
            },
            'fr': {
                'name': u'Réduire les émissions de CO₂',
                'unit': u'kg',
                'text': u'réduire les émissions de CO₂',
                'text_with_target': u'Émissions de CO₂ réduites',
                'text_passed': u'réduire les émissions de CO₂ de {} kg',
            },
            'nl': {
                'name': u'CO₂ uitstoot verminderen',
                'unit': u'kg',
                'text': u'CO₂ uitstoot te verminderen',
                'text_with_target': u'CO₂ uitstoot met {} kg te verminderen',
                'text_passed': u'CO₂ uitstoot verminderd'
            }
        },
        {
            'slug': 'people',
            'icon': 'people',
            'en': {
                'name': u'Reach people',
                'unit': u'',
                'text': u'reach people',
                'text_with_target': 'reach {} people',
                'text_passed': u'people reached',
            },
            'fr': {
                'name': u'Touchez les gens',
                'unit': u'',
                'text': u'touchez les gens',
                'text_with_target': 'toucher {} personnes',
                'text_passed': u'personnes touchés',
            },
            'nl': {
                'name': u'Mensen bereiken',
                'unit': u'',
                'text': u'mensen te bereiken',
                'text_with_target': '{} mensen te bereiken',
                'text_passed': u'mensen bereikt'
            }
        },
        {
            'slug': 'food',
            'icon': '',
            'en': {
                'name': u'Reduce food waste',
                'unit': u'kg',
                'text': u'reduce food waste',
                'text_with_target': 'reduce food waste by {} kg',
                'text_passed': u'food waste reduced',
            },
            'fr': {
                'name': u'Réduisez le gaspillage alimentaire',
                'unit': u'kg',
                'text': u'réduisez le gaspillage alimentaire',
                'text_with_target': 'réduire le gaspillage alimentaire de {} kg',
                'text_passed': u'gaspillage alimentaire réduit',
            },
            'nl': {
                'name': u'Voedselverspilling verminderen',
                'unit': u'kg',
                'text': u'voedselverspilling te verminderen',
                'text_with_target': 'voedselverspilling met {} kg te verminderen',
                'text_passed': u'voedselverspilling verminderd'
            }
        },
        {
            'slug': 'water',
            'icon': 'water',
            'en': {
                'name': u'Save water',
                'unit': u'l',
                'text': u'save water',
                'text_with_target': 'save {} l water',
                'text_passed': u'water saved',
            },
            'fr': {
                'name': u'Économiser l\'eau',
                'unit': u'l',
                'text': u'économiser l\'eau',
                'text_with_target': 'économisez {} l d\'eau',
                'text_passed': u'eau économisée',
            },
            'nl': {
                'name': u'Water besparen',
                'unit': u'l',
                'text': u'water te besparen',
                'text_with_target': '{} l water te besparen',
                'text_passed': u'water bespaard'
            }
        },
        {
            'slug': 'plastic',
            'icon': 'plastic',
            'en': {
                'name': u'Save plastic',
                'unit': u'kg',
                'text': u'save plastic',
                'text_with_target': 'save {} kg plastic',
                'text_passed': u'plastic saved',
            },
            'fr': {
                'name': u'Économisez du plastique',
                'unit': u'kg',
                'text': u'économisez du plastique',
                'text_with_target': 'économisez {} kg de plastique',
                'text_passed': u'plastique économisé',
            },
            'nl': {
                'name': u'Plastic besparen',
                'unit': u'kg',
                'text': u'plastic te besparen',
                'text_with_target': '{} kg plastic te besparen',
                'text_passed': u'plastic bespaard'
            }
        },
        {
            'slug': 'trees',
            'icon': 'trees',
            'en': {
                'name': u'Plant trees',
                'unit': u'',
                'text': u'plant trees',
                'text_with_target': 'plant {} trees',
                'text_passed': u'trees planted',
            },
            'fr': {
                'name': u'Planter des arbres',
                'unit': u'',
                'text': u'planter des arbres',
                'text_with_target': 'planter {} arbres',
                'text_passed': u'arbres plantés',
            },
            'nl': {
                'name': u'Bomen planten',
                'unit': u'',
                'text': u'bomen te planten',
                'text_with_target': '{} bomen te planten',
                'text_passed': u'bomen geplant'
            }
        },
        {
            'slug': 'jobs',
            'icon': 'jobs',
            'en': {
                'name': u'Create jobs',
                'unit': u'',
                'text': u'create jobs',
                'text_with_target': 'create {} jobs',
                'text_passed': u'jobs created',
            },
            'fr': {
                'name': u'Créer des emplois',
                'unit': u'',
                'text': u'créer des emplois',
                'text_with_target': 'créer {} emplois',
                'text_passed': u'emplois créés',
            },
            'nl': {
                'name': u'Banen creëren',
                'unit': u'',
                'text': u'banen te creëren',
                'text_with_target': '{} banen te creëren',
                'text_passed': u'banen gecreëerd'
            }
        },
    ]

    for definition in definitions:
        impact_type, created = ImpactType.objects.update_or_create(
            slug=definition['slug'],
            defaults={
                'icon': definition['icon']
            }
        )
        for language in languages:
            if language in definition:
                ImpactTypeTranslation.objects.update_or_create(
                    language_code=language,
                    master_id=impact_type.id,
                    defaults=definition[language]
                )


def remove_impact_types(apps, schema_editor):
    ImpactType = apps.get_model('impact', 'ImpactType')
    ImpactType.objects.all().delete()


class Migration(migrations.Migration):

    dependencies = [
        ('impact', '0015_impacttypetranslation_name'),
    ]

    operations = [
        migrations.RunPython(create_default_impact_types, remove_impact_types)
    ]
