# Generated by Django 2.2.24 on 2021-10-12 10:56

# Generated by Django 2.2.24 on 2021-10-12 10:43

from django.db import migrations, connection

from bluebottle.clients.models import Client
from bluebottle.clients.utils import LocalTenant


def migrate_addresses(apps, schema_editor):
    tenant = Client.objects.get(schema_name=connection.tenant.schema_name)
    Member = apps.get_model('members', 'Member')
    Place = apps.get_model('geo', 'Place')

    with LocalTenant(tenant):
        for member in Member.objects.all():
            member.place = Place.objects.filter(object_id=member.id).first()
            member.save()


class Migration(migrations.Migration):

    dependencies = [
        ('members', '0047_auto_20211012_1255'),
    ]

    operations = [
        migrations.RunPython(
            migrate_addresses,
            migrations.RunPython.noop
        )
    ]
