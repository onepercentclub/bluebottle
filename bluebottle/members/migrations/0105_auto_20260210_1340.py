# Generated by Django 4.2.20 on 2026-02-10 12:40

from django.db import migrations

partner_permissions = [
    'members_member_api_read_own_member',
    'organizations_organization_view_organization',
    'organizations_organizationcontact_view_organizationcontact',
    'impact_impacttype_view_impacttype',
    'impact_impactgoal_view_impactgoal',
    'files_image_view_image',
    'files_relatedimage_view_relatedimage',
    'activities_organizer_view_organizer',
    'activities_activity_api_read_own_activity',
    'activities_team_view_team',
    'activities_team_api_read_team',
    'initiatives_initiative_api_read_own_initiative',
    'initiatives_initiative_api_add_own_initiative',
    'initiatives_initiative_api_change_own_initiative',
    'initiatives_initiative_api_change_own_running_initiative',
    'initiatives_initiative_api_delete_own_initiative',
    'initiatives_theme_view_theme',
    'initiatives_theme_api_read_theme',
    'time_based_dateactivityslot_api_read_dateactivityslot',
    'time_based_dateactivityslot_api_add_dateactivityslot',
    'time_based_dateactivityslot_api_change_dateactivityslot',
    'time_based_dateactivityslot_api_delete_dateactivityslot',
    'time_based_dateactivityslot_api_read_own_dateactivityslot',
    'time_based_dateactivityslot_api_add_own_dateactivityslot',
    'time_based_dateactivityslot_api_change_own_dateactivityslot',
    'time_based_dateactivityslot_api_delete_own_dateactivityslot',
    'time_based_dateactivity_api_delete_own_dateactivity',
    'time_based_timebasedactivity_view_timebasedactivity',
    'time_based_dateactivityslot_view_dateactivityslot',
    'time_based_dateactivity_api_read_own_dateactivity',
    'time_based_dateactivity_api_add_own_dateactivity',
    'time_based_dateactivity_api_change_own_dateactivity',
    'time_based_dateactivity_api_delete_own_dateactivity',
    'time_based_dateactivityslot_view_dateactivityslot',
    'time_based_dateactivityslot_api_read_own_dateactivityslot',
    'time_based_dateactivityslot_api_read_own_dateactivityslot',
    'time_based_dateactivityslot_api_change_own_dateactivityslot',
    'time_based_dateactivityslot_api_change_own_dateactivityslot',
    'time_based_dateparticipant_view_dateparticipant',
    'time_based_dateparticipant_api_read_dateparticipant',
    'time_based_dateparticipant_api_change_dateparticipant',
    'time_based_dateparticipant_api_read_dateparticipant',
    'time_based_dateparticipant_api_read_dateparticipant',
    'time_based_dateparticipant_api_read_dateparticipant',
    'time_based_periodparticipant_api_read_periodparticipant',
    'time_based_periodparticipant_api_change_periodparticipant',
    'time_based_periodparticipant_view_periodparticipant',
    'time_based_timecontribution_view_timecontribution',
    'time_based_skill_api_read_skill',
    'time_based_skill_view_skill',
    'time_based_registration_view_registration',
    'time_based_registration_view_registration',
    'time_based_oldslotparticipant_api_change_slotparticipant',
    'time_based_oldslotparticipant_api_read_slotparticipant',
    'time_based_oldslotparticipant_api_change_slotparticipant',
    'collect_collecttype_view_collecttype',
    'collect_collecttype_api_read_collecttype',
    'collect_collectactivity_api_add_own_collect',
    'collect_collectactivity_api_change_own_collect',
    'collect_collectactivity_api_delete_own_collect',
    'collect_collectcontributor_api_read_collectcontributor',
    'collect_collectcontributor_view_collectcontributor',
    'collect_collectcontribution_view_collectcontribution',
    'deeds_deedparticipant_view_deedparticipant',
    'deeds_deed_api_read_own_deed',
    'deeds_deed_api_add_own_deed',
    'deeds_deed_api_change_own_deed',
    'deeds_deed_api_delete_own_deed',
    'deeds_deedparticipant_api_read_deedparticipant',
    'funding_funding_api_read_own_funding',
    'funding_funding_api_change_own_funding',
    'funding_funding_api_add_own_funding',
    'funding_funding_api_delete_own_funding',
    'funding_reward_view_reward',
    'funding_moneycontribution_view_moneycontribution',
    'funding_bankaccount_view_bankaccount',
    'funding_budgetline_view_budgetline',
    'funding_donor_view_donor',
    'geo_region_view_region',
    'geo_subregion_view_subregion',
    'geo_country_view_country',
    'geo_locationgroup_view_locationgroup',
    'geo_location_view_location',
    'geo_place_view_place',
    'geo_geolocation_view_geolocation',
    'geo_geolocation_view_geolocation',
    'geo_geolocation_view_geolocation',
    'pages_columnsitem_view_columnsitem',
    'pages_imagetextitem_view_imagetextitem',
    'pages_imagetextrounditem_view_imagetextrounditem',
    'pages_page_api_read_page',
    'pages_platformpage_api_read_platformpage',
    'terms_terms_api_read_terms',
    'terms_termsagreement_api_read_termsagreement',
    'updates_updateimage_view_updateimage',
    'cms_linkgroup_view_linkgroup',
    'cms_link_view_link',
    'cms_projectscontent_view_projectscontent',
    'cms_projectsmapcontent_view_projectsmapcontent',
    'cms_step_view_step',
    'cms_stepscontent_view_stepscontent',
    'cms_locationscontent_view_locationscontent',
    'cms_logo_view_logo',
    'cms_logoscontent_view_logoscontent',
    'cms_plaintextitem_view_plaintextitem',
    'cms_imageplaintextitem_view_imageplaintextitem',
    'cms_imageitem_view_imageitem',
]

staff_permissions = [
    'funding_stripe_paymentintent_change_paymentintent',
    'funding_stripe_stripepayment_add_stripepayment',
    'funding_stripe_stripepayment_change_stripepayment',
    'funding_stripe_stripesourcepayment_change_stripesourcepayment',
    'funding_stripe_stripepaymentprovider_change_stripepaymentprovider',
    'segments_segmenttype_add_segmenttype',
    'segments_segmenttype_change_segmenttype',
    'segments_segmenttype_delete_segmenttype',
    'segments_segment_add_segment',
    'segments_segment_change_segment',
    'segments_segment_delete_segment',
    'members_usersegment_add_usersegment',
    'members_usersegment_change_usersegment',
    'members_usersegment_delete_usersegment',
    'geo_region_add_region',
    'geo_region_change_region',
    'geo_region_delete_region',
    'geo_subregion_add_subregion',
    'geo_subregion_change_subregion',
    'geo_subregion_delete_subregion',
    'geo_country_add_country',
    'geo_country_change_country',
    'geo_country_delete_country',
    'geo_locationgroup_add_locationgroup',
    'geo_locationgroup_change_locationgroup',
    'geo_locationgroup_delete_locationgroup',
    'statistics_statistic_add_statistic',
    'statistics_statistic_change_statistic',
    'statistics_statistic_delete_statistic',
    'updates_update_add_update',
    'updates_update_change_update',
    'updates_update_delete_update',
    'updates_updateimage_add_updateimage',
    'updates_updateimage_change_updateimage',
    'updates_updateimage_delete_updateimage',
    'cms_homepage_api_read_homepage',
    'cms_homepage_api_add_homepage',
    'cms_homepage_api_change_homepage',
    'cms_homepage_api_delete_homepage',
    'cms_resultpage_api_read_resultpage',
    'cms_homepage_view_homepage',
    'cms_linkpermission_add_linkpermission',
    'cms_linkpermission_change_linkpermission',
    'cms_linkpermission_delete_linkpermission',
    'cms_linkgroup_add_linkgroup',
    'cms_linkgroup_change_linkgroup',
    'cms_linkgroup_delete_linkgroup',
    'cms_sitelinks_add_sitelinks',
    'cms_sitelinks_change_sitelinks',
    'cms_sitelinks_delete_sitelinks',
]


def add_staff_and_partner_permissions(apps, schema_editor):
    Group = apps.get_model('auth', 'Group')
    Permission = apps.get_model('auth', 'Permission')

    perm_mapping = {}

    for perm in Permission.objects.all():
        ct = perm.content_type
        perm_mapping[ct.app_label + '_' + ct.model + '_' + perm.codename] = perm
        perm_mapping[ct.app_label + '_' + ct.model + '_' + perm.codename] = perm

    partner_group, _ = Group.objects.get_or_create(name='Partner')
    for perm_str in partner_permissions:
        try:
            perm = perm_mapping[perm_str]
            partner_group.permissions.add(perm)
        except KeyError:
            import ipdb;
            ipdb.set_trace()
    staff_group, _ = Group.objects.get_or_create(name='Staff')
    for perm_str in staff_permissions:
        try:
            perm = perm_mapping[perm_str]
            staff_group.permissions.add(perm)
        except KeyError:
            import ipdb;
            ipdb.set_trace()
    staff_group.save()


class Migration(migrations.Migration):
    dependencies = [
        ('members', '0104_alter_member_name'),
    ]

    operations = [
        migrations.RunPython(add_staff_and_partner_permissions, migrations.RunPython.noop),
    ]
